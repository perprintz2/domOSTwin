"estimated":  true
},
"Shower": {
"temperature": 21.9,
"estimated":  true
}
}',
host = "deis-mqtt01.cs.aau.dk")
Sys.time()
rmqtt::mqtt_topic_publish( topic = 'domOS/iytwqe',
message_to_send = '{
"address": "Ravnkildevej13",
"time": 1635756218341,
"livingRoom": {
"temperature": 21.9,
"estimated":  true
},
"Kitchen": {
"temperature": 21.9,
"estimated":  true
},
"BedRoom": {
"temperature": 21.9,
"estimated":  true
},
"Room1": {
"temperature": 21.9,
"estimated":  true
},
"Room2": {
"temperature": 21.9,
"estimated":  true
},
"Shower": {
"temperature": 21.9,
"estimated":  true
}
}',
host = "deis-mqtt01.cs.aau.dk")
rmqtt::mqtt_topic_publish( topic = 'domOS/iytwqe',
message_to_send = c'{
"address": "Ravnkildevej13",
"time": 1635756218341,
"livingRoom": {
"temperature": 21.9,
"estimated":  true
},
"Kitchen": {
"temperature": 21.9,
"estimated":  true
},
"BedRoom": {
"temperature": 21.9,
"estimated":  true
},
"Room1": {
"temperature": 21.9,
"estimated":  true
},
"Room2": {
"temperature": 21.9,
"estimated":  true
},
"Shower": {
"temperature": 21.9,
"estimated":  true
}
}',
host = "deis-mqtt01.cs.aau.dk")
rmqtt::mqtt_topic_publish( topic = 'domOS/iytwqe',
message_to_send = c('{
"address": "Ravnkildevej13",
"time": 1635756218341,
"livingRoom": {
"temperature": 21.9,
"estimated":  true
},
"Kitchen": {
"temperature": 21.9,
"estimated":  true
},
"BedRoom": {
"temperature": 21.9,
"estimated":  true
},
"Room1": {
"temperature": 21.9,
"estimated":  true
},
"Room2": {
"temperature": 21.9,
"estimated":  true
},
"Shower": {
"temperature": 21.9,
"estimated":  true
}
}'),
host = "deis-mqtt01.cs.aau.dk")
Sys.time()
rmqtt::mqtt_topic_publish( topic = 'domOS/iytwqe',
message_to_send = c('{
/"address/": "Ravnkildevej13",
"time": 1635756218341,
"livingRoom": {
"temperature": 21.9,
"estimated":  true
},
"Kitchen": {
"temperature": 21.9,
"estimated":  true
},
"BedRoom": {
"temperature": 21.9,
"estimated":  true
},
"Room1": {
"temperature": 21.9,
"estimated":  true
},
"Room2": {
"temperature": 21.9,
"estimated":  true
},
"Shower": {
"temperature": 21.9,
"estimated":  true
}
}'),
host = "deis-mqtt01.cs.aau.dk")
Sys.time()
'AHFG"hags'
rmqtt::mqtt_topic_publish( topic = 'domOS/iytwqe',
message_to_send = c('{
\"address": "Ravnkildevej13",
"time": 1635756218341,
"livingRoom": {
"temperature": 21.9,
"estimated":  true
},
"Kitchen": {
"temperature": 21.9,
"estimated":  true
},
"BedRoom": {
"temperature": 21.9,
"estimated":  true
},
"Room1": {
"temperature": 21.9,
"estimated":  true
},
"Room2": {
"temperature": 21.9,
"estimated":  true
},
"Shower": {
"temperature": 21.9,
"estimated":  true
}
}'),
host = "deis-mqtt01.cs.aau.dk")
rmqtt::mqtt_topic_publish( topic = 'domOS/iytwqe',
message_to_send = '"',
host = "deis-mqtt01.cs.aau.dk")
rmqtt::mqtt_topic_publish( topic = 'domOS/iytwqe',
message_to_send = 'jkagdskjagj',
host = "deis-mqtt01.cs.aau.dk")
rmqtt::mqtt_topic_publish( topic = 'domOS/iytwqe',
message_to_send = 'jka""""gdskjagj',
host = "deis-mqtt01.cs.aau.dk")
rmqtt::mqtt_topic_publish( topic = 'domOS/iytwqe',
message_to_send = 'jka""gdskj""agj',
host = "deis-mqtt01.cs.aau.dk")
ww<- '{
""address"": ""Ravnkildevej13"",
""time"": 1635756218341,
""livingRoom"": {
""temperature"": 21.9,
""estimated"":  true
},
""Kitchen"": {
""temperature"": 21.9,
""estimated"":  true
},
""BedRoom"": {
""temperature"": 21.9,
""estimated"":  true
},
""Room1"": {
""temperature"": 21.9,
""estimated"":  true
},
""Room2"": {
""temperature"": 21.9,
""estimated"":  true
},
""Shower"": {
""temperature"": 21.9,
""estimated"":  true
}
}'
rmqtt::mqtt_topic_publish( topic = 'domOS/iytwqe',
message_to_send = ww,
host = "deis-mqtt01.cs.aau.dk")
result <- fromJSON(ww)
ww
ww<- '{
""address"": ""Ravnkildevej13"",
""time"": 1635756218341,
""livingRoom"": {
""temperature"": 21.9,
""estimated"":  true
}
}'
result <- fromJSON(ww)
rmqtt::mqtt_topic_publish( topic = 'domOS/iytwqe',
message_to_send = ww,
host = "deis-mqtt01.cs.aau.dk")
ww<- '{
""address"": ""Ravnkildevej13"",
""time"": 1635756218341,
""livingRoom"": {
""temperature"": 21.9,
""estimated"":  true
}
}'
rmqtt::mqtt_topic_publish( topic = 'domOS/iytwqe',
message_to_send = ww,
host = "deis-mqtt01.cs.aau.dk")
ww<- '{
""address"":""Ravnkildevej13"",
""time"": 1635756218341,
""livingRoom"": {""temperature"": 21.9,""estimated"":  true}
}'
jsonTxt <- toJSON(result)
ww<- '{
""address"":""Ravnkildevej13"",
""time"": 1635756218341,
""livingRoom"": {""temperature"": 21.9,""estimated"":  true}
}'
rmqtt::mqtt_topic_publish( topic = 'domOS/iytwqe',
message_to_send = ww,
host = "deis-mqtt01.cs.aau.dk")
ww<- '{
""address"":""Ravnkildevej13"",
""time"": 1635756218341,
""livingRoom"": {""temperature"":21.9,""estimated"":true}
}'
rmqtt::mqtt_topic_publish( topic = 'domOS/iytwqe',
message_to_send = ww,
host = "deis-mqtt01.cs.aau.dk")
ww<- '{""address"":""Ravnkildevej13"",""time"": 1635756218341,""livingRoom"": {""temperature"":21.9,""estimated"":true}}'
jsonTxt <- toJSON(result)
rmqtt::mqtt_topic_publish( topic = 'domOS/iytwqe',
message_to_send = ww,
host = "deis-mqtt01.cs.aau.dk")
rmqtt::mqtt_topic_publish( topic = 'domOS/iytwqe',
message_to_send = ww,
host = "deis-mqtt01.cs.aau.dk")
ww<- '{""address"":""Ravnkildevej13"",""time"":1635756218341,""livingRoom"":{""temperature"":21.9,""estimated"":true}}'
rmqtt::mqtt_topic_publish( topic = 'domOS/iytwqe',
message_to_send = ww,
host = "deis-mqtt01.cs.aau.dk")
Sys.time()
rmqtt::mqtt_topic_publish( topic = 'domOS/iytwqe',
message_to_send = ww,
host = "deis-mqtt01.cs.aau.dk")
ww<- '{""address"":""Ravnkildevej13""}'
rmqtt::mqtt_topic_publish( topic = 'domOS/iytwqe',
message_to_send = ww,
host = "deis-mqtt01.cs.aau.dk")
ww<- '{[1,2,3]}'
rmqtt::mqtt_topic_publish( topic = 'domOS/iytwqe',
message_to_send = ww,
host = "deis-mqtt01.cs.aau.dk")
ww<- '{}'
rmqtt::mqtt_topic_publish( topic = 'domOS/iytwqe',
message_to_send = ww,
host = "deis-mqtt01.cs.aau.dk")
ww<- '{""address"":""Ravnkildevej13""}'
rmqtt::mqtt_topic_publish( topic = 'domOS/iytwqe',
message_to_send = ww,
host = "deis-mqtt01.cs.aau.dk")
ww<- '{"address":"Ravnkildevej13"}'
rmqtt::mqtt_topic_publish( topic = 'domOS/iytwqe',
message_to_send = ww,
host = "deis-mqtt01.cs.aau.dk")
ww<- "{\"address\":\"Ravnkildevej13\"}"
rmqtt::mqtt_topic_publish( topic = 'domOS/iytwqe',
message_to_send = ww,
host = "deis-mqtt01.cs.aau.dk")
rmqtt::mqtt_topic_publish( topic = 'domOS/iytwqe',
message_to_send = ww,
host = "deis-mqtt01.cs.aau.dk")
Sys.time()
ww<- '{""address"":""Ravnkildevej13""}'
rmqtt::mqtt_topic_publish( topic = 'domOS/iytwqe',
message_to_send = ww,
host = "deis-mqtt01.cs.aau.dk")
rmqtt::mqtt_topic_publish( topic = 'domOS/iytwqe',
message_to_send = ww,
host = "deis-mqtt01.cs.aau.dk")
data<- '{""address"":""Ravnkildevej13"",""time"":234152,""livingRoom"":{""temperature"":21.9,""estimated"":""true""},""kitchen"":{""temperature"": 21.9,""estimated"":  ""true""},""bedRoom1"": {""temperature"": 21.9,""estimated"":  ""true""}""Room1"":{""temperature"":21.9,""estimated"":""true""}""Room2"": {""temperature"": 21.9,""estimated"":  ""true""}""shower"": {""temperature"": 21.9,""estimated"":  ""true""}	}'
rmqtt::mqtt_topic_publish( topic = 'domOS/iytwqe',
message_to_send = data,
host = "deis-mqtt01.cs.aau.dk")
data<- '{""address"":""Ravnkildevej13"",""time"":234152,""livingRoom"":{""temperature"":21.9,""estimated"":""true""},""kitchen"":{""temperature"": 21.9,""estimated"":  ""true""},""bedRoom1"": {""temperature"": 21.9,""estimated"":  ""true""},""Room1"":{""temperature"":21.9,""estimated"":""true""},""Room2"": {""temperature"": 21.9,""estimated"":  ""true""},""shower"": {""temperature"": 21.9,""estimated"":  ""true""}	}'
rmqtt::mqtt_topic_publish( topic = 'domOS/iytwqe',
message_to_send = data,
host = "deis-mqtt01.cs.aau.dk")
data<- '{""address"":""Ravnkildevej13"",
""time"":234152,
""livingRoom"":{""temperature"":21.9,""estimated"":""true""},""kitchen"":{""temperature"": 21.9,""estimated"":  ""true""},""bedRoom1"": {""temperature"": 21.9,""estimated"":  ""true""},""Room1"":{""temperature"":21.9,""estimated"":""true""},""Room2"": {""temperature"": 21.9,""estimated"":  ""true""},""shower"": {""temperature"": 21.9,""estimated"":  ""true""}	}'
rmqtt::mqtt_topic_publish( topic = 'domOS/iytwqe',
message_to_send = data,
host = "deis-mqtt01.cs.aau.dk")
data<- '{""address"":""Ravnkildevej13"",
""time"":234152,
""livingRoom"":{
""temperature"":21.9,
""estimated"":""true""},
""kitchen"":{
""temperature"": 21.9,
""estimated"":  ""true""},
""bedRoom1"": {
""temperature"": 21.9,
""estimated"":  ""true""},
""Room1"":{
""temperature"":21.9,
""estimated"":""true""},
""Room2"": {
""temperature"": 21.9,
""estimated"":  ""true""},
""shower"": {
""temperature"": 21.9,
""estimated"":  ""true""}
}'
rmqtt::mqtt_topic_publish( topic = 'domOS/iytwqe',
message_to_send = data,
host = "deis-mqtt01.cs.aau.dk")
data<- '{""address"":""Ravnkildevej13"",
""time"":234152,
""livingRoom"":{
""temperature"":21.9,
""estimated"":true},
""kitchen"":{
""temperature"": 21.9,
""estimated"":  true},
""bedRoom1"": {
""temperature"": 21.9,
""estimated"":  true},
""Room1"":{
""temperature"":21.9,
""estimated"":true},
""Room2"": {
""temperature"": 21.9,
""estimated"":  true},
""shower"": {
""temperature"": 21.9,
""estimated"":  true}
}'
rmqtt::mqtt_topic_publish( topic = 'domOS/iytwqe',
message_to_send = data,
host = "deis-mqtt01.cs.aau.dk")
rmqtt::mqtt_topic_publish( topic = 'domOS/Ravnkildevej13/HouseModel',
message_to_send = data,
host = "deis-mqtt01.cs.aau.dk")
plumber::plumb(file='plumber.R')$run()
plumber::plumb(file='plumber.R')$run()
plumber::plumb(file='plumber.R')$run()
plumber::plumb(file='plumber.R')$run()
a=1
a<-1
a
plumber::plumb(file='plumber.R')$run()
plumber::plumb(file='plumber.R')$run()
plumber::plumb(file='plumber.R')$run()
plumber::plumb(file='plumber.R')$run()
fff(list(1,2,3,4))
f1tst(list(1,2,3,4))
f1tst<-function(a) {
aa<-list(1,2,3,4,5)
}
f1tst<-function(a) {
aa<-list(1,2,3,4,5)
}
f1tst(list(1,2,3,4))
aa
dd=f1tst(list(1,2,3,4))
dd
dd(3)
dd[3]
dd[0]
dd[1]
plumber::plumb(file='plumber.R')$run()
aa<-list(10,20,30,40,50)
plumber::plumb(file='plumber.R')$run()
f1tst<-function(a) {
aa<-list(10,20,30,40,50)
}
plumber::plumb(file='plumber.R')$run()
## Init by deleting all variables and functions
rm(list=ls())
## Set the working directory
setwd(".")
## Use the CTSM-R package, note that first the package must be installed,
## see the Installation section in the CTSM-R Userguide
library(ctsmr)
write('PATH="${RTOOLS40_HOME}\\usr\\bin;${PATH}"', file = "~/.Renviron", append = TRUE)
plumber::plumb(file='plumber.R')$run()
plumber::plumb(file='plumber.R')$run(port="8085")
plumber::plumb(file='plumber.R')$run(port="8087")
plumber::plumb(file='plumber.R')$run(port="4000")
plumber::plumb(file='plumber.R')$run()
plumber::plumb(file='plumber.R')$run(port="9274")
plumber::plumb(file='plumber.R')$run(port=8085)
require(ctsmr)
## Generate a new object of class ctsm
model <- ctsm()
## Add a system equation and thereby also a state
model$addSystem(dTi ~ ( 1/(Ci*Ria)*(Ta-Ti) )*dt + exp(p11)*dw1)
## Set the names of the inputs
model$addInput(Ta)
## ## Alternatively add the heater
## model$addSystem(dTi ~ ( 1/(Ci*Ria)*(Ta-Ti) + 1/Ci * Ph )*dt + exp(p11)*dw1)
## model$addInput(Ta,Ph)
## Set the observation equation: Ti is the state, yTi is the measured output
model$addObs(yTi ~ Ti)
## Set the variance of the measurement error
model$setVariance(yTi ~ exp(e11))
## Set the initial value (for the optimization) of the value of the state at the starting   time point
##model$setParameter(  Ti = c(init=15  ,lb=0     ,ub=25 ) )
model$setParameter(  Ti = c(init=X$yTi[1] ,lb=0     ,ub=25 ) )
## Set the initial value for the optimization
model$setParameter(  Ci = c(init=10   ,lb=1E-5  ,ub=500 ) )
model$setParameter( Ria = c(init=20  ,lb=1     ,ub=1E4) )
model$setParameter( p11 = c(init=1   ,lb=-30   ,ub=10 ) )
model$setParameter( e11 = c(init=-1  ,lb=-50   ,ub=10 ) )
## Needs to be runned for simulate to work
model$AnalyseModel()
## Make a fit object to pass to simulate.ctsmr
fit <- list()
fit$model <- model
fit$xm <- model$ParameterValues$initial
names(fit$xm) <- row.names(model$ParameterValues)
## Can be nessary such that xm has the right length
fit$xm <- fit$xm[model$pars]
class(fit) <- "ctsmr"
## Simulate with the initial values
sim <- simulate(fit, newdata=X)
str(sim)
## or
sim2 <- ctsmr:::simulate.ctsmr(fit, newdata=X)
str(sim2)
## Plot the simulated output
plot(X$t, sim$output$sim$yTi, type='l', ylim=range(sim$output$sim$yTi, X$yTi, X$Ta))
lines(X$t, X$yTi, type='l', col=2)
lines(X$t, X$Ta, type='l')
## Now go up and uncomment the lines with code with the heater (uncomment the two similar) and run again
## Try to change the parameter values
prm <- list()
## Init by deleting all variables and functions
rm(list=ls())
## Set the working directory
setwd("C:/Users/SZ33IZ/OneDrive - Aalborg Universitet/Dokumenter/CTSM Room 1-Living Room/CTSM Room 1-Living Room")
## Use the CTSM-R package, note that first the package must be installed,
## see the Installation section in the CTSM-R Userguide
library(ctsmr)
prm <- list()
X <- read.csv("data DT.csv", sep=",", header=TRUE)
## Init by deleting all variables and functions
rm(list=ls())
## Set the working directory
setwd("C:/Users/SZ33IZ/OneDrive - Aalborg Universitet/Dokumenter/CTSM Room 1-Living Room/CTSM Room 1-Living Room")
## Use the CTSM-R package, note that first the package must be installed,
## see the Installation section in the CTSM-R Userguide
library(ctsmr)
## List with global parameters
prm <- list()
## Number of threads used by CTSM-R for the estimation computations
prm$threads <- 4
## Source the scripts with functions in the "functions" folder
## Just a neat way of arranging helping functions in R
files <- dir("functions", full.names=TRUE)
for(i in 1:length(files)) source(files[i])
## Read the data into a data.frame
X <- read.csv("data DT.csv", sep=",", header=TRUE)
## Set the names of the columns in X
## X$t is now hours since start of the experiment
## Create a column in the POSIXct format for plotting etc.
X$timedate <- asP("2009-02-05 14:26:00)") + X$Time
X$t <- X$Time / 3600
X$Tdiff <- X$Tforward-X$Treturn
X <- subset(X, Time <= 60*60*24*4)
## Fit the TiThTe model, see "functions/TiThTe.R"
roomModel <- TiThTe(X)
save(fit, file = "model1.rda")
save(roomModel, file = "model1.rda")
Pred <- predict(roomModel, n.ahead = 1)
rm(list=ls())
load(file = "model1.rda")
Pred <- predict(roomModel, n.ahead = 1)
Pred <- predict(roomModel, n.ahead = 10)
Pred <- predict(roomModel, n.ahead = 20)
a<- matrix(C(1,2,3,4,5,6))
a<- matrix(c(1,2,3,4,5,6))
a
a<- matrix(c(1,2,3,4,5,6),nrow=2)
a
r()
q()
